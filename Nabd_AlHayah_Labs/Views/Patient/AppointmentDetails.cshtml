@model Nabd_AlHayah_Labs.ViewModels.AppointmentViewModel

<div class="app-wrapper">
    <div class="app-content pt-3 p-md-3 p-lg-4">
        <div class="container-xl">
            <h1 class="mb-4">Appointment Details</h1>

            <!-- زر الرجوع أعلى الصفحة -->
            <a asp-action="Appointment" asp-route-patientId="@Model.Patient.PatientId" class="btn btn-secondary mb-3">
                <i class="fas fa-arrow-left me-1"></i> Back to Appointments
            </a>

            <!-- بيانات أساسية للموعد -->
            <div class="card shadow-sm mb-4 p-3">
                <h4>Basic Info</h4>
                <p><strong>Patient:</strong> @Model.Patient.FullNameEn (@Model.Patient.FullNameAr)</p>
                <p><strong>Date & Time:</strong> @Model.AppointmentDate.ToString("dd MMM yyyy HH:mm")</p>
                <p><strong>Appointment Type:</strong> @Model.AppointmentTypes.FirstOrDefault(t => t.Id == Model.AppointmentTypeId)?.Name</p>
                <p><strong>Status:</strong> @(Model.Status != null ? Model.Status.CodeDescEn : "Not set")</p>
                <p><strong>Notes:</strong> @Model.Notes</p>
            </div>

            <!-- الفحوصات -->
            <div class="card shadow-sm mb-4 p-3">
                <h4>Tests</h4>
                @if (Model.SelectedTestIds != null && Model.SelectedTestIds.Any())
                {
                    <ul>
                        @foreach (var testId in Model.SelectedTestIds)
                        {
                            <li>@Model.Tests.FirstOrDefault(t => t.Id == testId)?.Name</li>
                        }
                    </ul>
                }
                else
                {
                    <p>No tests selected.</p>
                }
            </div>

            <!-- الباقات -->
            <div class="card shadow-sm mb-4 p-3">
                <h4>Packages</h4>
                @if (Model.SelectedPackageIds != null && Model.SelectedPackageIds.Any())
                {
                    <ul>
                        @foreach (var pkgId in Model.SelectedPackageIds)
                        {
                            <li>@Model.Packages.FirstOrDefault(p => p.Id == pkgId)?.Name</li>
                        }
                    </ul>
                }
                else
                {
                    <p>No packages selected.</p>
                }
            </div>

            <!-- بيانات السحب المنزلي -->
            @if (Model.AppointmentTypeId == 10 && (Model.AddressAr != null || Model.CityAr != null))
            {
                <div class="card shadow-sm mb-4 p-3">
                    <h4>Home Sampling Info</h4>
                    <p><strong>Address (AR):</strong> @Model.AddressAr</p>
                    <p><strong>Address (EN):</strong> @Model.AddressEn</p>
                    <p><strong>City (AR):</strong> @Model.CityAr</p>
                    <p><strong>City (EN):</strong> @Model.CityEn</p>
                    <p><strong>Technician Name:</strong> @Model.TechnicianName</p>
                    <p><strong>Is For Another Person:</strong> @(Model.IsForAnotherPerson ? "Yes" : "No")</p>
                </div>
            }

            <!-- زر الرجوع أسفل الصفحة -->
            <a asp-action="Appointment" asp-route-patientId="@Model.Patient.PatientId" class="btn btn-secondary mb-3">
                <i class="fas fa-arrow-left me-1"></i> Back to Appointments
            </a>
        </div>
    </div>
</div>
